@startuml
Class SpaceController {
    - SpaceService spaceService
    + void CreateSpace(req)
    + void UpdateSpace(req)
    + void GetSpaceById(req)
    + void GetAllSpaces(req)
    + void DeleteSpace(req)
}

Class SpaceService {
    - UsersService usersService
    - SpaceRepository spaceRepository
    + Space CreateSpace(username, password, location, substation, price, capacity, img)
    + void UpdateSpace(spaceId, username, password, location, substation, price, capacity, img)
    + Space GetSpaceById(spaceId)
    + Space[] GetAllSpaces()
    + int DeleteSpace(spaceId, username, password)
}

Class UsersControllers {
    - UsersService usersService
    + void CreateUser(req)
    + void ValidateUser(req)
    + void UserIsAdmin(req)
    + void GetUserById(req)
    + void GetAllUsers(req)
}

Class UsersService {
    - UsersRepository usersRepository
    + int GetUserId(username)
    + bool AuthenticateUser(username, password)
    + bool UserIsAdmin(userId)
    + bool CreateUser(username, password, isAdmin)
    + User GetUserById(userId)
    + User[] GetAllUsers()
}

Class UsersRepository {
    + int, error Insert(user)
    + User GetUserById(userId)
    + User GetUserByName(username)
    + User[] GetAllUsers()
}

Class SpaceRepository {
    - Database db
    + int, error Insert(space)
    + Space GetSpaceById(id)
    + error Update(space)
    + Space[] GetAllSpaces()
    + error DeleteSpace(id)
}

Class Space {
    - int id
    - string location
    - string substation
    - double price
    - int capacity
    - byte[] img
}

Class User {
    - int id
    - string username
    - string passHash
    - bool isAdmin
}

Class BookingController {
    - BookingService bookingService
    + void CreateBooking(req)
    + void GetBookingById(req)
    + void GetAllBookings(req)
    + void CancelBooking(req)
}

Class BookingService {
    - BookingRepository bookingRepository
    - UsersService usersService
    - SpaceService spaceService
    + Book CreateBooking(data, userId, spaceId, paid, hasDeposit)
    + Book[] GetAllBookings()
    + Book GetBookingById(bookingId)
    + bool CancelBooking(req)
}

Class BookingRepository {
    - Database db
    + bool SaveBooking(book)
    + Book GetBookingById(id)
    + Book[] GetAllBookings()
    + bool DeleteBooking(book)
}

Class Book {
    - Date date
    - User user
    - Space space
    - bool paid
    - bool signalDeposit
}

Class PixController {
    - PixService pixService
    + void MakePartialPix(req)
    + void MakeFullPix(req)
}

Class PixService {
    - PixRepository pixRepository
    + Pix MakePartialPix(name, value)
    + Pix MakeFullPix(name, value)
    + Pix GetPixById(pixId)
}

Class PixRepository {
    - Database db
    + bool SavePix(pix)
    + Pix GetPixById(pixId)
}

Class Pix {
    - int id
    - string name
    - double value
}


SpaceController --> SpaceService : "Chama métodos"
SpaceService -d-> Space : "Cria / usa"
SpaceService -l-> SpaceRepository : "Chama métodos"
SpaceService --> UsersService : "Chama métodos"

UsersService --> UsersRepository : "Chama métodos"
UsersService --> User : "Cria / usa"

SpaceRepository -d-> Space : "Retorna"
UsersRepository --> User : "Retorna"

PixController --> PixService : "Chama métodos"
PixService -r-> PixRepository : "Chama métodos"
PixRepository --> Pix : "Retorna"
PixService --> Pix : "Cria / usa"

BookingController --> BookingService : "Chama métodos"
BookingService --> BookingRepository : "Chama métodos"
BookingService -l-> SpaceService : "Chama métodos"
BookingService -d-> UsersService : "Chama métodos"
BookingService --> Book : "Cria / usa"
BookingRepository --> Book : "Retorna"

SpaceController -r[hidden]-> BookingController
BookingController -l[hidden]-> SpaceController
BookingController -r[hidden]-> PixController
PixController -l[hidden]-> BookingController

UsersControllers --> UsersService : "Chama Métodos"

@enduml
